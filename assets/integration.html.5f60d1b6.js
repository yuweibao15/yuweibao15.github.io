import{_ as p}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c as l,b as n,d as e,f as a,e as s,r as i}from"./app.affcf331.js";const c={},r=a(`<p>What tools can we use to do numerical integration?</p><h2 id="python-scipy-integrate" tabindex="-1"><a class="header-anchor" href="#python-scipy-integrate" aria-hidden="true">#</a> Python scipy.integrate</h2><h3 id="purpose" tabindex="-1"><a class="header-anchor" href="#purpose" aria-hidden="true">#</a> Purpose</h3><p>Solve a double integral numerically.</p><h3 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>pip <span class="token function">install</span> scripy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="usage-examples" tabindex="-1"><a class="header-anchor" href="#usage-examples" aria-hidden="true">#</a> Usage Examples</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>help<span class="token punctuation">(</span>integrate<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_1-simple-single-integral" tabindex="-1"><a class="header-anchor" href="#_1-simple-single-integral" aria-hidden="true">#</a> 1. Simple single integral</h4>`,9),u=n("p",null,[s("To calculate $$I(a,b) = \\int_0^1 a x^2 + b \\quad dx$$ when "),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"a"),n("mo",null,"="),n("mn",null,"2"),n("mo",{separator:"true"},","),n("mi",null,"b"),n("mo",null,"="),n("mn",null,"1")]),n("annotation",{encoding:"application/x-tex"},"a=2, b=1")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.4306em"}}),n("span",{class:"mord mathnormal"},"a"),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),n("span",{class:"mord"},"2"),n("span",{class:"mpunct"},","),n("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),n("span",{class:"mord mathnormal"},"b"),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.6444em"}}),n("span",{class:"mord"},"1")])])])],-1),d=a(`<div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>integrate <span class="token keyword">import</span> quad
<span class="token keyword">def</span> <span class="token function">integrand</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> a<span class="token operator">*</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> b

a <span class="token operator">=</span> <span class="token number">2</span>
b <span class="token operator">=</span> <span class="token number">1</span>
I <span class="token operator">=</span> quad<span class="token punctuation">(</span>integrand<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre>(1.6666666666666667, 1.8503717077085944e-14)
</pre><p>The return value is a tuple in the form of <code>(estimated value of the integral, an upper bound on the error)</code></p><h4 id="_2-single-integral-with-exponential" tabindex="-1"><a class="header-anchor" href="#_2-single-integral-with-exponential" aria-hidden="true">#</a> 2. Single integral with exponential</h4>`,4),m=n("p",null,[s("To calculate $$I(x) = \\int_1^\\infty \\frac{e^{-xt}}{2} dt$$ when "),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"t"),n("mo",null,"="),n("mn",null,"2")]),n("annotation",{encoding:"application/x-tex"},"t=2")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.6151em"}}),n("span",{class:"mord mathnormal"},"t"),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.6444em"}}),n("span",{class:"mord"},"2")])])])],-1),k=a(`<div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>integrate <span class="token keyword">import</span> quad
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">def</span> <span class="token function">integrand</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">*</span>t<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>

t <span class="token operator">=</span> <span class="token number">2</span>
I <span class="token operator">=</span> quad<span class="token punctuation">(</span>integrand<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre>(0.03383382080915317, 5.2341136313236115e-12)
</pre><h4 id="_3-double-integral-with-non-constant-integration-bounds" tabindex="-1"><a class="header-anchor" href="#_3-double-integral-with-non-constant-integration-bounds" aria-hidden="true">#</a> 3. Double integral with non-constant integration bounds</h4><p>To calculate</p>`,4),h=n("p",{class:"katex-block"},[n("span",{class:"katex-display"},[n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[n("semantics",null,[n("mrow",null,[n("mi",null,"I"),n("mo",null,"="),n("msubsup",null,[n("mo",null,"\u222B"),n("mrow",null,[n("mi",null,"y"),n("mo",null,"="),n("mn",null,"0")]),n("mn",null,"0.5")]),n("msubsup",null,[n("mo",null,"\u222B"),n("mrow",null,[n("mi",null,"x"),n("mo",null,"="),n("mn",null,"0")]),n("mrow",null,[n("mn",null,"1"),n("mo",null,"\u2212"),n("mn",null,"2"),n("mi",null,"y")])]),n("mi",null,"x"),n("mi",null,"y"),n("mspace",{width:"1em"}),n("mi",null,"d"),n("mi",null,"x"),n("mi",null,"d"),n("mi",null,"y")]),n("annotation",{encoding:"application/x-tex"},"I=\\int_{y=0}^{0.5} \\int_{x=0}^{1-2y} xy \\quad dx dy ")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.6833em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07847em"}},"I"),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"2.6121em","vertical-align":"-1.0481em"}}),n("span",{class:"mop"},[n("span",{class:"mop op-symbol large-op",style:{"margin-right":"0.44445em",position:"relative",top:"-0.0011em"}},"\u222B"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"1.564em"}},[n("span",{style:{top:"-1.7881em","margin-left":"-0.4445em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"y"),n("span",{class:"mrel mtight"},"="),n("span",{class:"mord mtight"},"0")])])]),n("span",{style:{top:"-3.8129em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mtight"},"0.5")])])])]),n("span",{class:"vlist-s"},"\u200B")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"1.0481em"}},[n("span")])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),n("span",{class:"mop"},[n("span",{class:"mop op-symbol large-op",style:{"margin-right":"0.44445em",position:"relative",top:"-0.0011em"}},"\u222B"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"1.564em"}},[n("span",{style:{top:"-1.7881em","margin-left":"-0.4445em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mathnormal mtight"},"x"),n("span",{class:"mrel mtight"},"="),n("span",{class:"mord mtight"},"0")])])]),n("span",{style:{top:"-3.8129em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mtight"},"1"),n("span",{class:"mbin mtight"},"\u2212"),n("span",{class:"mord mtight"},"2"),n("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"y")])])])]),n("span",{class:"vlist-s"},"\u200B")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.9119em"}},[n("span")])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),n("span",{class:"mord mathnormal"},"x"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),n("span",{class:"mspace",style:{"margin-right":"1em"}}),n("span",{class:"mord mathnormal"},"d"),n("span",{class:"mord mathnormal"},"x"),n("span",{class:"mord mathnormal"},"d"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y")])])])])],-1),g=a(`<p>[Method 1]</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> scipy <span class="token keyword">import</span> integrate
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x<span class="token operator">*</span>y

<span class="token keyword">def</span> <span class="token function">bounds_y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">bounds_x</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>y<span class="token punctuation">]</span>

I <span class="token operator">=</span> integrate<span class="token punctuation">.</span>nquad<span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token punctuation">[</span>bounds_x<span class="token punctuation">,</span>bounds_y<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>[Method 2]</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>integrate <span class="token keyword">import</span> dblquad
area <span class="token operator">=</span> dblquad<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x<span class="token operator">*</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">)</span>
area
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre>(0.010416666666666668, 4.1016201284723663e-16)
</pre><h4 id="_4-something-i-learned-in-practice-with-double-integrals" tabindex="-1"><a class="header-anchor" href="#_4-something-i-learned-in-practice-with-double-integrals" aria-hidden="true">#</a> 4. Something I learned in practice with double integrals</h4><p>In practice, I found that we should define the boundaries differently based on either it is non-constant integration or constant integration. A. <strong>With non-constant integration bounds</strong> We can refer to the previous section. Notice, something <strong>doesn&#39;t work</strong> here will be:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> scipy <span class="token keyword">import</span> integrate
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x<span class="token operator">*</span>y

I <span class="token operator">=</span> integrate<span class="token punctuation">.</span>nquad<span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>y<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The error message is:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>
  File <span class="token string">&quot;PATH_TO/test.py&quot;</span><span class="token punctuation">,</span> line <span class="token number">5</span><span class="token punctuation">,</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>
    <span class="token constant">I</span> <span class="token operator">=</span> integrate<span class="token punctuation">.</span><span class="token function">nquad</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>y<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token literal-property property">NameError</span><span class="token operator">:</span> name <span class="token string">&#39;y&#39;</span> is not defined
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>B. <strong>With constant integration bounds</strong> To calculate $$I=\\int_0^\\infty \\int_1^\\infty \\frac{e<sup>{-xt}}{t</sup>n} \\quad dt dx = \\frac{1}{n}$$</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> scipy <span class="token keyword">import</span> integrate
N <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">return</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">*</span>t<span class="token punctuation">)</span> <span class="token operator">/</span> t<span class="token operator">**</span>N

integrate<span class="token punctuation">.</span>nquad<span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre>(0.20000000000002294, 1.2239614263187945e-08)
</pre><p>Notice, something <strong>doesn&#39;t work</strong> here will be using Section 3 [Method 1].</p><h3 id="references" tabindex="-1"><a class="header-anchor" href="#references" aria-hidden="true">#</a> References</h3><ol><li>Scipy manual <sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup></li><li>Numerical Methods using Python (scipy) <sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup></li></ol><hr class="footnotes-sep">`,17),b={class:"footnotes"},v={class:"footnotes-list"},y={id:"footnote1",class:"footnote-item"},f={href:"https://docs.scipy.org/doc/scipy/tutorial/integrate.html",target:"_blank",rel:"noopener noreferrer"},x=s("https://docs.scipy.org/doc/scipy/tutorial/integrate.html"),_=s(),w=n("a",{href:"#footnote-ref1",class:"footnote-backref"},"\u21A9\uFE0E",-1),I={id:"footnote2",class:"footnote-item"},q={href:"https://www.southampton.ac.uk/~fangohr/teaching/python/book/html/16-scipy.html",target:"_blank",rel:"noopener noreferrer"},M=s("https://www.southampton.ac.uk/~fangohr/teaching/python/book/html/16-scipy.html"),z=s(),$=n("a",{href:"#footnote-ref2",class:"footnote-backref"},"\u21A9\uFE0E",-1);function N(T,S){const t=i("ExternalLinkIcon");return o(),l("div",null,[r,u,d,m,k,h,g,n("section",b,[n("ol",v,[n("li",y,[n("p",null,[n("a",f,[x,e(t)]),_,w])]),n("li",I,[n("p",null,[n("a",q,[M,e(t)]),z,$])])])])])}const B=p(c,[["render",N],["__file","integration.html.vue"]]);export{B as default};
